{% extends 'birds/base.html' %}

	{% block content %}
		<div class="page-content">
			<section class="mdl-grid">
				<div class="mdl-cell mdl-cell--12-col">	
				<div class="mdl-cell mdl-cell--10-col-desktop mdl-cell--1-offset-desktop mdl-card mdl-shadow--3dp">
					<div class="mdl-card__title" id="faq">
						<h2 class="mdl-card__title-text">User Profile</h2>
					</div>
					<div class="mdl-card__supporting-text">
					<b>User Name: </b><a class="capitalize">{{ user.username }}</a>
					</div>
					<div class="mdl-card__supporting-text">
					<b>Avatar: </b>
					<div id="avatar_container">
					{% if user.avatar %}
						<img class="mdl-shadow--2dp" src="{{ user.avatar.avatar.url }}">
					{% endif %}
					</div>
					<div id="add_avatar_button" class="mdl-button mdl-button--primary mdl-button--icon mdl-button--file">
						<div id="photo" class="mdl-tooltip--right material-icons">add_a_photo</div>
						<div class="mdl-tooltip mdl-tooltip--right" for="photo">
							Add/Replace Avatar
						</div>
					</div>
					
					<input id="avatar_photo" type="file" style="display:none">
					</div>
				</div>
				</div>
			</section>
		</div>
<script type="text/javascript">


jQuery(function($){

	$('#add_avatar_button').click(function(){
		$('#avatar_photo').trigger('click');
	});
	
	$('#avatar_photo').change(function(){
		formdata = new FormData();
		var file = this.files[0];
		if (formdata) {
			formdata.append("avatar_photo", file);
			formdata.append("csrfmiddlewaretoken", "{{ csrf_token }}");
			$.ajax({
				url: "{% url 'birds:add_avatar' %}",
				data: formdata,
				type: "POST",
				dataType: "json",
				processData: false,
				contentType: false,
				success: function(data) {
					if (data.msg == "success"){
						$('#avatar_container').html('<img src="' + data.url + '">');
					}
				},
				error: function(jqXHR, textStatus, errorThrown){
					alert(textStatus);
				}
			});
		}
	})

});


</script>

{% endblock %}
